---
const { accent = '#7BE7FF' } = Astro.props;
---

<!-- Backdrop layers -->
<div class="hallway" style={`--accent:${accent};--complement:var(--cursor);`} aria-hidden="true">
  <div class="hallway__photo"></div>
  <div class="hallway__vignette"></div>
  <div class="hallway__fog"></div>
  <div class="hallway__atmosphere"></div>
  <div class="hallway__depth"></div>
  <div class="hallway__walls"></div>
  <div class="hallway__neon"></div>
  <div class="hallway__grain"></div>

  <!-- cursor light (moves with pointer) -->
  <div class="hallway__cursorLight" id="cursorLight"></div>
</div>

<style>
  .hallway {
    position: fixed;
    inset: 0;
    z-index: 0;
    pointer-events: none;
    overflow: hidden;
  }

  .hallway__photo {
    position: absolute;
    inset: -10%;
    background-image:
      radial-gradient(
        900px 420px at 58% 16%,
        color-mix(in oklab, var(--complement) 38%, transparent),
        transparent 62%
      ),
      linear-gradient(180deg, rgba(4, 9, 18, 0.5) 0%, rgba(4, 8, 15, 0.72) 48%, rgba(3, 6, 12, 0.88) 100%),
      var(--hallway-photo-url);
    background-position: center;
    background-size: cover;
    background-repeat: no-repeat;
    filter: saturate(1.08) contrast(1.06) brightness(0.62);
    opacity: 0.44;
    transform: scale(1.03);
  }

  /* vignette (like camera/scene) */
  .hallway__vignette {
    position: absolute;
    inset: -10%;
    background: radial-gradient(closest-side at 50% 40%, transparent 55%, rgba(0, 0, 0, 0.72) 95%);
    opacity: 0.9;
  }

  /* fog/mist */
  .hallway__fog {
    position: absolute;
    inset: -20%;
    background:
      radial-gradient(600px 260px at 35% 35%, rgba(255, 255, 255, 0.055), transparent 62%),
      radial-gradient(700px 320px at 70% 45%, rgba(255, 255, 255, 0.046), transparent 67%),
      radial-gradient(900px 420px at 50% 70%, rgba(255, 255, 255, 0.034), transparent 72%);
    filter: blur(11px);
    opacity: 0.52;
    animation: hallwayFogDrift 28s ease-in-out infinite alternate;
  }

  .hallway__atmosphere {
    position: absolute;
    inset: -18%;
    background:
      radial-gradient(
        780px 420px at 15% 18%,
        color-mix(in oklab, var(--accent) 24%, transparent),
        transparent 70%
      ),
      radial-gradient(
        840px 460px at 84% 24%,
        color-mix(in oklab, var(--complement) 24%, transparent),
        transparent 72%
      ),
      radial-gradient(
        1000px 520px at 50% 82%,
        rgba(255, 255, 255, 0.03),
        transparent 72%
      );
    opacity: 0.34;
    filter: blur(18px) saturate(1.08);
    animation: hallwayBreathe 24s ease-in-out infinite;
  }

  .hallway__depth {
    position: absolute;
    inset: -16%;
    background:
      radial-gradient(85% 58% at 50% 62%, rgba(255, 255, 255, 0.05), transparent 75%),
      repeating-linear-gradient(
        90deg,
        color-mix(in oklab, var(--complement) 9%, transparent) 0 1px,
        transparent 1px 22px
      ),
      repeating-linear-gradient(
        0deg,
        color-mix(in oklab, var(--accent) 8%, transparent) 0 1px,
        transparent 1px 28px
      );
    mix-blend-mode: soft-light;
    opacity: 0.24;
    transform: translate3d(
      calc((var(--hallway-x, 50vw) - 50vw) / 58),
      calc((var(--hallway-y, 34vh) - 34vh) / 72),
      0
    ) scale(1.04);
    transition: transform var(--motion-slow, 420ms) var(--ease-standard, ease);
  }

  /* corridor "walls" / subtle perspective */
  .hallway__walls {
    position: absolute;
    inset: -30%;
    background:
      linear-gradient(
        90deg,
        color-mix(in oklab, var(--complement) 24%, transparent),
        transparent 24%,
        transparent 76%,
        color-mix(in oklab, var(--accent) 24%, transparent)
      ),
      linear-gradient(
        180deg,
        rgba(0, 0, 0, 0),
        rgba(0, 0, 0, 0.32) 52%,
        rgba(0, 0, 0, 0.67)
      );
    transform: perspective(900px) rotateX(8deg);
    opacity: 0.78;
  }

  /* neon tubes + glow edges */
  .hallway__neon {
    position: absolute;
    inset: -10%;
    background:
      radial-gradient(
        600px 220px at 50% 12%,
        color-mix(in oklab, var(--complement) 34%, transparent),
        transparent 60%
      ),
      radial-gradient(
        800px 360px at 50% 20%,
        color-mix(in oklab, var(--accent) 36%, transparent),
        transparent 70%
      ),
      linear-gradient(
        90deg,
        color-mix(in oklab, var(--complement) 18%, transparent),
        transparent 24%,
        transparent 76%,
        color-mix(in oklab, var(--accent) 20%, transparent)
      );
    filter: blur(1px);
    opacity: 0.88;
  }

  /* grain (world texture) */
  .hallway__grain {
    position: absolute;
    inset: -10%;
    background-image:
      repeating-linear-gradient(
        0deg,
        rgba(255, 255, 255, 0.03) 0px,
        rgba(255, 255, 255, 0.03) 1px,
        transparent 2px,
        transparent 4px
      ),
      repeating-linear-gradient(
        90deg,
        rgba(255, 255, 255, 0.02) 0px,
        rgba(255, 255, 255, 0.02) 1px,
        transparent 2px,
        transparent 6px
      );
    mix-blend-mode: overlay;
    opacity: 0.11;
    animation: hallwayBreathe 18s ease-in-out infinite reverse;
  }

  /* cursor "flashlight" reveal */
  .hallway__cursorLight {
    position: absolute;
    width: 560px;
    height: 560px;
    left: var(--mx, 50%);
    top: var(--my, 45%);
    transform: translate(-50%, -50%);
    background: radial-gradient(
      circle at center,
      color-mix(in oklab, var(--cursor) 20%, transparent) 0%,
      transparent 72%
    );
    filter: blur(12px);
    opacity: calc(var(--cursor-light-visibility, 1) * 0.46);
    transition: opacity var(--motion-ambient, 1200ms) var(--ease-emphasized, ease);
    mix-blend-mode: screen;
  }

  @keyframes hallwayFogDrift {
    from {
      transform: translate3d(-0.8%, -0.5%, 0) scale(1.01);
    }
    to {
      transform: translate3d(0.8%, 0.6%, 0) scale(1.04);
    }
  }

  @keyframes hallwayBreathe {
    0%,
    100% {
      opacity: 0.18;
    }
    50% {
      opacity: 0.3;
    }
  }

  @media (pointer: coarse) {
    .hallway__cursorLight {
      display: none;
    }
  }

  /* Respect reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .hallway__fog,
    .hallway__atmosphere,
    .hallway__grain {
      animation: none;
    }

    .hallway__depth {
      transform: none;
      transition: none;
    }

    .hallway__fog,
    .hallway__cursorLight { opacity: 0.2; }
  }

  @media (max-width: 860px) {
    .hallway__atmosphere {
      opacity: 0.24;
    }

    .hallway__depth {
      opacity: 0.15;
    }
  }
</style>
