---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import SubstackPanel from '../../components/SubstackPanel.astro';

const posts = (await getCollection('posts')).sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---
<BaseLayout title="Writing â€” a_e.s_">
  <h1 class="font-display text-4xl">Writing</h1>
  <a class="mt-2 inline-block text-sm underline" href="/rss.xml">RSS feed</a>
  <SubstackPanel />
  <ul class="mt-6 space-y-4">
    {posts.map((post) => (
      <li class="rounded border border-zinc-300 p-4 dark:border-zinc-700">
        <a href={`/writing/${post.slug}`} class="font-display text-xl">{post.data.title}</a>
        <p class="text-sm text-zinc-600 dark:text-zinc-300">{post.data.date.toLocaleDateString()}</p>
        <p class="mt-1">{post.data.summary}</p>
        <div class="mt-2 flex flex-wrap gap-2">
          {post.data.tags.map((tag) => <span class="rounded bg-zinc-200 px-2 py-0.5 text-xs dark:bg-zinc-800">#{tag}</span>)}
        </div>
      </li>
    ))}
  </ul>
</BaseLayout>
