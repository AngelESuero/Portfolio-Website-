---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import ProjectCard from '../../components/ProjectCard.astro';

const allProjects = await getCollection('projects');
const types = ['all', 'music', 'video', 'writing', 'civic'];
---
<BaseLayout title="Work â€” a_e.s_">
  <h1 class="font-display text-4xl">Work / Projects</h1>
  <p class="mt-3">Filter by type and explore the archive.</p>
  <div class="mt-4 flex flex-wrap gap-2" id="filters">
    {types.map((type) => <button class="filter rounded border border-zinc-400 px-3 py-1 text-sm dark:border-zinc-600" data-filter={type}>{type}</button>)}
  </div>
  <div class="mt-6 flex gap-4 overflow-x-auto pb-2 md:grid md:grid-cols-3 md:overflow-visible" id="project-grid">
    {allProjects.map((project) => <div class="project-item" data-type={project.data.type}><ProjectCard project={project} /></div>)}
  </div>
</BaseLayout>

<script is:inline>
  const buttons = document.querySelectorAll('.filter');
  const items = document.querySelectorAll('.project-item');
  buttons.forEach((btn) => {
    btn.addEventListener('click', () => {
      const filter = btn.dataset.filter;
      items.forEach((item) => {
        const type = item.getAttribute('data-type');
        item.style.display = filter === 'all' || filter === type ? 'block' : 'none';
      });
    });
  });
</script>
